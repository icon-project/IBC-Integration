// Copyright 2022 ComposableFi
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

use prost::alloc::vec::Vec;

/// Abstract of consensus state update information
pub trait ClientMessage: Clone + core::fmt::Debug + Send + Sync {
    fn downcast<T: Clone + 'static>(self) -> Option<T>
    where
        Self: 'static,
    {
        <dyn core::any::Any>::downcast_ref(&self).cloned()
    }

    fn wrap(sub_state: &dyn core::any::Any) -> Option<Self>
    where
        Self: 'static,
    {
        sub_state.downcast_ref::<Self>().cloned()
    }

    fn encode_to_vec(&self) -> Result<Vec<u8>, prost::EncodeError>;
}
